webpackJsonp([7],{"8EpJ":function(e,t){},gpVb:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("mvHQ"),i=s.n(o),a=s("Dd8w"),n=s.n(a),c=s("NYxO"),l=s("Y54T"),r=s("yojn"),h=s.n(r),d=s("Au9i"),u={data:function(){return{homeDeviceList:this.$store.state.homeDeviceList,fastNodesList:this.$store.state.fastNodesList,selected:this.$store.state.homeMenu,blueEnable:!0,locationGranted:!0,locationEnabled:!0,flag:!1,onoff:!1,isSwitchUI:!1,isSwitchOnOff:!1,selectList:this.$store.state.homeSelectList,proxyAddress:"",connectContent:0,connectData:"",isBleConnect:!1,homedeviceGroup:this.$store.state.deviceGroupList,pullLoad:!1,loadShow:!1,topStatus:"",startTime:0,isGetDetailData:!1,groupsList:[],groupsDetail:{},homeNewDevice:[]}},beforeDestroy:function(){console.log("即将离开 Home 页面")},watch:{$route:"getPath"},created:function(){var e=this;window.getMeshNetworkCallback=function(t){e.getMeshNetworkCallback(t)},window.scanCallback=function(t){e.scanCallback(t)},window.connectCallback=function(t){e.connectCallback(t)},window.meshMessageCallback=function(t){e.meshMessageCallback(t)},window.onBackPressed=function(){e.onBackPressed()},window.getMeshInfoCallback=function(t){e.getMeshInfoCallback(t)},window.getGroupsCallback=function(t){e.getGroupsCallback(t)}},methods:n()({},Object(c.c)({setNum:"SET_NUM"}),{getGroupsCallback:function(e){e=l.a.base64().decode(e),console.log("FBY getGroupsCallback"+e),e=JSON.parse(e),l.a._isEmpty(e)||(this.groupsList=e,this.selectList.length>2&&this.selectList.splice(2,this.selectList.length-2),this.$store.commit("setHomeSelectList",this.selectList))},getMeshInfoCallback:function(e){e=l.a.base64().decode(e),console.log("FBY getMeshInfoCallback"+e),e=JSON.parse(e),l.a._isEmpty(e)||(homedeviceGroup,"node"===e.type&&0===this.selected?(this.homeDeviceList=e.nodes,this.$store.commit("setHomeDeviceList",this.homeDeviceList)):"fastNode"===e.type&&1===this.selected?this.fastNodesList=e.fastNodes:"group"===e.type&&this.groupsList[this.selected].address===e.address&&(this.groupsDetail[this.selected]=e)),this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect?this.sendBLEMeshData():this.homeDeviceScan(this),console.log("getMeshInfoCallback getHomeAllList 1"),this.getHomeAllList(this.selected),console.log("getMeshInfoCallback getHomeAllList 2")},testClick:function(){},onBackPressed:function(){Object(d.Toast)({message:this.$t("exitProgramDesc"),position:"bottom",duration:2e3}),0===this.startTime?this.startTime=(new Date).getTime():(new Date).getTime()-this.startTime<2e3?EspBleMesh.finish():this.startTime=(new Date).getTime()},loadTop:function(){console.log("下拉刷新");var e=this,t={};e.isGetDetailData=!0,e.pullLoad=!0,setTimeout(function(){e.loadShow?(e.pullLoad=!1,e.$refs.loadmore.onTopLoaded()):(e.loadShow=!0,0===e.selected?t.type="node":1===e.selected?t.type="fastNode":(t.type="group",t.address=e.groupsList[e.selected].address),EspBleMesh.getMeshNetwork())},50),setTimeout(function(){e.loadShow=!1,e.pullLoad=!1,e.isGetDetailData=!1,e.$refs.loadmore.onTopLoaded()},5e3)},handleTopChange:function(e){this.topStatus=e;var t=document.getElementsByClassName("mint-loadmore-content");console.log("FBY arr"+i()(t)),this.pullLoad?(t[0].classList.add("pullLoad"),this.topStatus="loading",this.$refs.loadmore.topStatus="loading"):t[0].classList.remove("pullLoad")},getPath:function(){console.log("路由发生变化"+this.$route.path),"/home"===this.$route.path||EspBleMesh.stopScan()},scanCallback:function(e){l.a.scanCallback(e,this)},connectCallback:function(e){l.a.connectCallback(e,this,this.isGetDetailData)},showBlueFail:function(){console.log("点击蓝牙图标")},showUl:function(){this.flag=!this.flag},getHomeAllList:function(e){return this.$store.commit("setHomeMenu",e),console.log("Home 菜单栏选择："+e),0===e?(console.log("FBY Home homeDeviceList: "+i()(this.homeDeviceList)),this.homeDeviceList):1===e?this.fastNodesList:(console.log("FBY Home homedeviceGroup selected: "+e),console.log("FBY Home homedeviceGroup address: "+i()(this.homedeviceGroup)),l.a._isEmpty(this.homedeviceGroup[e-2])?[]:this.homedeviceGroup[e-2].models)},homeMenu:function(e){console.log("点击配网"+e),this.flag=!1,"1"===e?(EspBleMesh.stopScan(),this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect&&l.a.proxyDisconnect(this),this.$router.togo({name:"sigprovision",query:{type:e}})):"2"===e?(this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect?(EspBleMesh.stopScan(),this.$router.togo({name:"firstprovision",query:{type:e}})):l.a.messageRemind(this.$t("fastremind"))):console.log("新建网络")},operateItem:function(e,t){console.log("点击 cell 控制设备"+i()(e));this.flag=!1,this.pullLoad||(this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect?this.pushNextPage(e):(EspBleMesh.stopScan(),l.a.messageRemind(this.$t("bleConnecting")),this.$store.commit("setBleWillConnectAddress",e.address),this.homeDeviceScan()))},pushNextPage:function(e){var t=!0,s="";EspBleMesh.stopScan(),this.$store.commit("setDeviceInfo",e),this.selected>1&&(s=this.homedeviceGroup[this.selected-2].address,t=!1),this.$router.togo({name:"operation",query:{item:e,isNode:t,groupAddress:s,menuSelect:this.selected}})},switchUI:function(){console.log("点击切换 UI"),this.isSwitchUI=!this.isSwitchUI},getIcon:function(e){return l.a.getIconUtil(e)},getBxColor:function(e){return e.address===this.$store.state.bleConnectAddress?"bx-red":""},getColor:function(e){return l.a.getColorUtil(e)},isLight:function(e){return l.a.isLight(e)},switchItem:function(e){this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect?this.close(e,!e.status):l.a.messageRemind(this.$t("devicebleconnecting"))},homeDeviceScan:function(){l.a.homeDeviceScan(this)},scanTimeout:function(){l.a.scanTimeout(this)&&l.a.messageRemind(this.$t("unconnectable"))},close:function(e,t){var s={},o="";console.log("FBY close device: "+i()(e)+" status: "+t),s[h.a.KEY_OP_CODE]=h.a.GENERIC_ON_OFF_SET_UNACKNOWLEDGED,this.selected>1?(s[h.a.KEY_DST_ADDRESS]=e.elementAddress,s[h.a.KEY_NODE_ADDRESS]=e.nodeAddress):(s[h.a.KEY_DST_ADDRESS]=e.address,s[h.a.KEY_NODE_ADDRESS]=e.address),s[h.a.KEY_STATE]=t,this.isBleConnect=this.$store.state.isBleConnect,this.isBleConnect?l.a.sendMeshMessage(this,s):(l.a.messageRemind(this.$t("trybleconnect")),this.homeDeviceScan()),o=this.selected>1?e.nodeAddress:e.address,l.a.updateNodesStatus(this,o,t,"status")},sendBLEMeshData:function(){l.a.sendBLEMeshData(this)},sendMeshMessage:function(e){l.a.sendMeshMessage(this,e)},getMeshNetworkCallback:function(e){l.a.getMeshNetworkCallback(e,this)},getMeshGroupData:function(e,t){var s=this;console.log("getMeshGroupData : "+i()(s.selectList)),s.selectList.length>2&&s.selectList.splice(2,s.selectList.length-2),console.log("FBY Home getMeshGroupData:"+i()(e)+"     selectList: "+i()(s.selectList)),e=l.a.setMeshGroupsData(e,t,s),s.homedeviceGroup=e,s.homedeviceGroup.forEach(function(e){s.selectList.push(e.name)}),console.log("FBY Home getMeshGroupData selectList: "+i()(s.selectList)),s.$store.commit("setHomeSelectList",s.selectList),console.log("FBY Home getMeshGroupData newGroups:"+i()(e))},meshMessageCallback:function(e){l.a.meshMessageCallback(e,this,"home")},getFastProvNodeAddrCallback:function(e){this.fastNodesList=l.a.fastNodesStatus(this,e),console.log("FBY getFastProvNodeAddrCallback fastNodesList: "+i()(this.fastNodesList))}}),mounted:function(){console.log("mounted 走了")},activated:function(){var e=this;console.log("activated 走了: "+i()(e.selectList)),e.selectList.length>1?(e.selectList.splice(0,1,e.$t("networknodes")),e.selectList.splice(1,1,e.$t("fastnodes"))):(e.selectList.push(e.$t("networknodes")),e.selectList.push(e.$t("fastnodes"))),window.getMeshNetworkCallback=function(t){e.getMeshNetworkCallback(t)},window.scanCallback=function(t){e.scanCallback(t)},window.connectCallback=function(t){e.connectCallback(t)},window.meshMessageCallback=function(t){e.meshMessageCallback(t)},window.onBackPressed=function(){e.onBackPressed()},e.isBleConnect=e.$store.state.isBleConnect,e.fastNodesList=e.$store.state.fastNodesList,e.connectContent=0,e.startTime=0,console.log("capabilities 返回传参打印"+i()(this.$route.query)),e.$route.query.type===h.a.CAPABILITIES&&(l.a._isEmpty(this.$route.query.node)||(e.homeDeviceList.push(this.$route.query.node),e.$store.commit("setHomeDeviceList",e.homeDeviceList),console.log("homeDeviceList 打印"+i()(e.homeDeviceList))))},deactivated:function(){console.log("deactivated 走了"),EspBleMesh.stopScan()},computed:n()({},Object(c.b)(["number"]),Object(c.d)({number:function(e){return e.home.number}}),{getBlueEnable:function(){return this.blueEnable=this.$store.state.blueInfo,this.locationGranted=this.$store.state.locationGranted,this.locationEnabled=this.$store.state.locationEnabled,console.log("状态实时更新 blueEnable:"+this.blueEnable+"  locationGranted:"+this.locationGranted+"  locationEnabled:"+this.locationEnabled),this.blueEnable},getDataList:function(){return this.homeDeviceList=this.$store.state.homeDeviceList,console.log("computed: "+i()(this.homeDeviceList)),this.getHomeAllList(this.selected)}})},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"index-content-box"},[o("div",{staticClass:"home-header"},[o("img",{staticClass:"esp-logo",attrs:{src:s("Cotv")},on:{click:function(t){return e.testClick()}}}),e._v(" "),o("p",{staticClass:"home-network"},[e._v("Espressif Network")]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.getBlueEnable,expression:"!getBlueEnable"}],staticClass:"bluetooth-base",on:{click:e.showBlueFail}},[o("i",{staticClass:"icon-bluetooth bluetooth-style"})]),e._v(" "),o("i",{staticClass:"icon-plus right-more",on:{click:function(t){return t.stopPropagation(),e.showUl()}}}),e._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:e.flag,expression:"flag"}],staticClass:"add-ul"},[o("li",{on:{click:function(t){return t.stopPropagation(),e.homeMenu("1")}}},[o("span",[e._v(e._s(e.$t("sigprovision")))])]),e._v(" "),o("li",{on:{click:function(t){return t.stopPropagation(),e.homeMenu("2")}}},[o("span",[e._v(e._s(e.$t("fastprovision")))])])])]),e._v(" "),o("div",{staticClass:"select-menu-base"},[o("div",{staticClass:"select-menu"},[o("mt-navbar",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.selectList,function(t,s){return o("mt-tab-item",{key:s,attrs:{id:s}},[e._v(e._s(t))])}),1)],1),e._v(" "),o("i",{staticClass:"icon-more home-switch-btn flex flex-ac flex-jcc",on:{click:function(t){return t.stopPropagation(),e.switchUI(t)}}})]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!e.isSwitchUI,expression:"!isSwitchUI"}],staticClass:"content-info scan-device flex-wrapper search-device"},[o("div",{staticClass:"overflow-touch"},[o("mt-loadmore",{ref:"loadmore",attrs:{"top-method":e.loadTop},on:{"top-status-change":e.handleTopChange}},[e._l(e.getDataList,function(t,s){return o("div",{key:s,staticClass:"item push-none",on:{click:function(s){return s.target!==s.currentTarget?null:e.operateItem(t)}}},[o("div",{staticClass:"item-icon-circle",class:e.getBxColor(t),on:{click:function(s){return s.stopPropagation(),e.operateItem(t)}}},[o("i",{class:e.getIcon(t.tid),style:{color:e.getColor(t)}})]),e._v(" "),o("div",{staticClass:"item-name",on:{click:function(s){return s.stopPropagation(),e.operateItem(t)}}},[o("span",[e._v(e._s(t.name))]),e._v(" "),o("span",{staticClass:"desc"},[e._v(e._s(e.$t("nodeAddresss"))+e._s(t.address)+"    "+e._s(e.$t("nodeVersion"))+e._s(t.version))])]),e._v(" "),o("div",{staticClass:"item-power"},[o("div",{directives:[{name:"show",rawName:"v-show",value:e.isLight(t.tid)&&e.isBleConnect,expression:"isLight(item.tid) && isBleConnect"}],staticClass:"switch-wrapper"},[o("span",{class:{active:!t.status},on:{click:function(s){return e.close(t,!1)}}},[e._v("OFF")]),e._v(" "),o("span",{class:{active:t.status},on:{click:function(s){return e.close(t,!0)}}},[e._v("ON")])])])])}),e._v(" "),o("div",{staticClass:"mint-loadmore-top",attrs:{slot:"top"},slot:"top"},[o("span",{directives:[{name:"show",rawName:"v-show",value:"loading"!==e.topStatus,expression:"topStatus !== 'loading'"}],class:{rotate:"drop"===e.topStatus}},[e._v("↓")]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:"loading"===e.topStatus,expression:"topStatus === 'loading'"}],attrs:{id:"loader-wrapper-small"}},[o("div",{staticClass:"loader loader-small"}),e._v(" "),o("div",{staticClass:"loader-section section-left"}),e._v(" "),o("div",{staticClass:"loader-section section-right"})])])],2)],1)]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:e.isSwitchUI,expression:"isSwitchUI"}],staticClass:"home-switch-base"},[o("div",{staticClass:"switch-base"},e._l(e.getHomeAllList(e.selected),function(t){return o("div",{key:t.address,staticClass:"switch-item",on:{click:function(s){return s.target!==s.currentTarget?null:e.switchItem(t)}}},[o("div",{staticClass:"switch-item-content",on:{click:function(s){return s.stopPropagation(),e.switchItem(t)}}},[o("i",{staticClass:"icon-light switch-icon-light",class:{switch:t.status}}),e._v(" "),o("span",{class:{"node-name":e.selected>1}},[e._v(e._s(t.name))])])])}),0)])])},staticRenderFns:[]};var p=s("VU/8")(u,m,!1,function(e){s("8EpJ")},null,null);t.default=p.exports}});
//# sourceMappingURL=7.458aa34091632e17e36a.js.map